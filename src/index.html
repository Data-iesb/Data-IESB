<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data IESB</title>
    <link rel="stylesheet" href="./style/home.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>

    <header>
    <div class="container nav-container">
        <div class="logo">
  	    <img src="https://d28lvm9jkyfotx.cloudfront.net/logo.png" alt="Data IESB Logo" style="width: 80px; height: 40px;">
	</div>


        <input type="checkbox" id="menu-toggle" class="menu-toggle">
        
        <label for="menu-toggle" class="hamburger-menu">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
        </label>

        <div class="nav-collapse">
            <nav>
                <ul>
                    <li><a class="active" href="index.html">Painéis e Estudos</a></li>
                    <li><a href="quem-somos.html">Quem somos</a></li>
                    <li><a href="parceiros.html">Parceiros</a></li>
                    <li><a href="contato.html">Contato</a></li>
                </ul>
            </nav>
            <!-- <div class="header-actions">
                <input type="search" placeholder="Pesquisar aqui">
                <button class="login-btn">Login</button>
            </div> -->
        </div>
    </div>
    </header>

    <main>
        <section class="hero">
            <div class="container hero-container">
                <div class="hero-text">
                    <span class="tag">Novidade</span>
                    <h1>Novo painel mostra os dados do ensino superior no Brasil</h1>
                    <p>Análises mostra como o investimento na educação superior foi implementado.</p>
                    <div class="hero-buttons">
                        <button class="btn btn-primary">Veja o estudo agora</button>
                        <!-- <button class="btn btn-secondary">Peça um painel personalizado</button> -->
                    </div>
                </div>
                <div class="hero-image">
                    <img src="https://d28lvm9jkyfotx.cloudfront.net/img/meeting.png" alt="Pessoas trabalhando em um escritório">
                    <div class="stat-card stat-1">
                        <h2>78%</h2>
                        <p>das cidades não possuem novos professores</p>
                    </div>
                    <div class="stat-card stat-2">
                        <h2>60%</h2>
                        <p>da verba destinada à educação foi reduzida</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="panels">
            <div class="container">
                <h2>Veja outros painéis lançados</h2>
                <p class="subtitle">Conheça nossos estudos sobre o PIB, Segurança Pública, Infraestrutura e Saneamento Básico no Brasil.</p>


                <div class="panels-grid" id="cards-container">
                    <!-- Cards serão inseridos aqui -->
                </div>
            </div>
        </section>

        <section class="student-apps">
            <div class="container">
                <h2>Aplicações De Alunos</h2>
                <p class="subtitle">Conheça as aplicações desenvolvidas pelos nossos alunos para facilitar o acesso aos dados públicos brasileiros.</p>
                
                <div class="apps-grid">
                    <div class="app-card">
                        <h3>Aurya</h3>
                        <p>Assistente virtual que permite consultar dados públicos brasileiros usando linguagem natural, sem necessidade de conhecimento técnico em SQL.</p>
                        <p><strong>Autor:</strong> Marcos Correia</p>
                        <a href="https://aurya.dataiesb.com/" target="_blank" rel="noopener noreferrer" class="btn btn-primary">Acessar Aplicação</a>
                    </div>
                    <div class="app-card">
                        <h3>OSINTube-RealTimeGuard</h3>
                        <p>Sistema de detecção de ameaças em tempo real para conteúdo do YouTube, garantindo segurança online através de monitoramento e análise contínuos.</p>
                        <p><strong>Autor:</strong> Roberto Moreira Diniz</p>
                        <a href="https://app.dataiesb.com/osintube" target="_blank" rel="noopener noreferrer" class="btn btn-primary">Acessar Aplicação</a>
                    </div>
                </div>
            </div>
        </section>

        <section class="newsletter">
            <div class="container newsletter-container">
                <div class="newsletter-text">
                    <h2>Não perca uma análise</h2>
                    <p>Cadastre seu e-mail e seja informado sempre que publicarmos um novo estudo</p>
                </div>
                <form class="newsletter-form">
                    <input type="email" placeholder="Seu e-mail">
                    <button type="submit" class="btn btn-primary">Inscreva-se</button>
                </form>
            </div>
        </section>
    </main>

    <footer>
        <div class="container footer-container">
            <p>&copy; 2025. Criado pelo Data IESB.</p>
            <nav>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="quem-somos.html">Quem Somos</a></li>
                    <li><a href="parceiros.html">Parceiros</a></li>
                    <li><a href="contato.html">Contato</a></li>
                </ul>
            </nav>
        </div>
    </footer>

    <script src="./js/navigation.js"></script>
</body>
<script>
  async function loadReports() {
    const container = document.getElementById("cards-container");
    // Updated to use DynamoDB API endpoint instead of reports.json
    const reportsApiUrl = "https://hewx1kjfxh.execute-api.us-east-1.amazonaws.com/prod/dataiesb-auth/public-reports";

    try {
      // Show loading state
      container.innerHTML = `
        <div style="text-align: center; padding: 40px; color: #666;">
          <div style="display: inline-block; width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid #007bff; border-radius: 50%; animation: spin 1s linear infinite;"></div>
          <p style="margin-top: 15px;">Carregando relatórios...</p>
        </div>
      `;

      const response = await fetch(reportsApiUrl);
      
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      
      const reports = await response.json();

      // Clear loading state
      container.innerHTML = '';

      // Debugging - Log the reports to check structure
      console.log("Reports data from DynamoDB: ", reports);

      // Ensure 'reports' is an object and it is not empty
      if (typeof reports === 'object' && reports !== null && !Array.isArray(reports)) {
        const reportIds = Object.keys(reports);
        
        if (reportIds.length === 0) {
          container.innerHTML = `
            <div style="text-align: center; padding: 40px; color: #666;">
              <p>Nenhum relatório disponível no momento.</p>
            </div>
          `;
          return;
        }

        // Sort reports by creation date if available, or by title
        reportIds.sort((a, b) => {
          const reportA = reports[a];
          const reportB = reports[b];
          
          // If created_at exists, sort by date (newest first)
          if (reportA.created_at && reportB.created_at) {
            return new Date(reportB.created_at) - new Date(reportA.created_at);
          }
          
          // Otherwise sort by title
          return reportA.titulo.localeCompare(reportB.titulo);
        });

        reportIds.forEach((id) => {
          const report = reports[id];

          // Ensure the report is valid (deletado is already filtered out by the API)
          if (report && report.titulo && report.descricao && report.autor) {
            const reportUrl = `http://app.dataiesb.com/report/?id=${id}`;
            const card = document.createElement("div");
            card.innerHTML = `
              <div class="panel-card" style="background-color: #f9f9f9; border-radius: 10px; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); transition: transform 0.2s ease, box-shadow 0.2s ease; cursor: pointer;" 
                   onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 4px 20px rgba(0,0,0,0.15)'" 
                   onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 10px rgba(0,0,0,0.1)'">
                <a href="${reportUrl}" style="text-decoration: none; color: inherit;">
                  <h3 style="font-size: 1.5rem; font-weight: 600; color: #333; margin-bottom: 15px;">${report.titulo}</h3>
                  <p style="font-size: 1rem; color: #555; margin-bottom: 15px; line-height: 1.5;">${report.descricao}</p>
                  <div style="display: flex; justify-content: space-between; align-items: center;">
                    <p style="font-size: 0.9rem; color: #777; margin: 0;">Autor: <strong>${report.autor}</strong></p>
                    <span style="font-size: 0.8rem; color: #007bff; font-weight: 500;">Ver relatório →</span>
                  </div>
                </a>
              </div>
            `;
            container.appendChild(card);
          } else {
            console.warn(`Skipping invalid report with ID: ${id}`, report);
          }
        });
      } else {
        console.error("Reports data is not an object or is empty:", reports);
        container.innerHTML = `
          <div style="text-align: center; padding: 40px; color: #dc3545;">
            <p>Erro ao carregar os dados dos relatórios.</p>
          </div>
        `;
      }
    } catch (error) {
      console.error("Erro ao carregar os relatórios:", error);
      container.innerHTML = `
        <div style="text-align: center; padding: 40px; color: #dc3545;">
          <p>Erro ao carregar os relatórios. Tente novamente mais tarde.</p>
          <button onclick="loadReports()" style="margin-top: 10px; padding: 8px 16px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">
            Tentar novamente
          </button>
        </div>
      `;
    }
  }

  // Add CSS animation for loading spinner
  const style = document.createElement('style');
  style.textContent = `
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  `;
  document.head.appendChild(style);

  window.onload = loadReports;
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</html>
<!-- Test deployment Sun Aug 10 11:39:05 AM -03 2025 -->
